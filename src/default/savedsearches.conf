[Potentially failing disk detected]
alert.severity = 5
alert.suppress = 1
alert.suppress.period = 10h
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
description = A disk drive that may be failing has been detected. This search indicates when SMART has indicated that a drive is failing or when important attributes known to be associated with drive failures indicate a failing drive.
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 1
quantity = 0
relation = greater than
search = sourcetype=smartmon Serial_Number=* (SMART_overall_health_self_assessment_test_result!="PASSED" OR (SMART_overall_health_self_assessment_test_result="FAILING_NOW")) | stats latest(SMART_overall_health_self_assessment_test_result) as SMART_overall_health_self_assessment_test_result by host Device_Model, Serial_Number | append [search sourcetype=smartmon Serial_Number=* | stats max(Reallocated_Sector_Ct) as Reallocated_Sector_Ct max(Offline_Uncorrectable) as Offline_Uncorrectable max(Command_Timeout) as Command_Timeout  max(Current_Pending_Sector) as Current_Pending_Sector max(Reported_Uncorrect) as Reported_Uncorrect by host, Device_Model, Serial_Number | eval Error_Message=case(Reallocated_Sector_Ct > 4, "Reallocated sector count is above 4", Offline_Uncorrectable > 1, "Offline uncorrectable error count is above 1", Command_Timeout > 13, "Command timeouts are above 13", Current_Pending_Sector > 1, "Current pending sector count is above 1", Reported_Uncorrect > 1, "Reported uncorrectable errors are above 1") | search Error_Message=*] | stats max(SMART_overall_health_self_assessment_test_result) as SMART_overall_health_self_assessment_test_result max(Reallocated_Sector_Ct) as Reallocated_Sector_Ct max(Offline_Uncorrectable) as Offline_Uncorrectable max(Command_Timeout) as Command_Timeout max(Current_Pending_Sector) as Current_Pending_Sector max(Reported_Uncorrect) as Reported_Uncorrect max(Error_Message) as Error_Message by host, Device_Model, Serial_Number